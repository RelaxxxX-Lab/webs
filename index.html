<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LUA | Modern Executor</title>
    <style>
        :root {
            --primary: #8a2be2;  /* Purple */
            --primary-light: #9d4edd;
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #ffffff;
            --gray: #1e1e1e;
            --gray-light: #2a2a2a;
            --sidebar-width: 280px;
            --accent: #8a2be2;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--light);
            display: flex;
            min-height: 100vh;
            overflow-x: hidden;
        }

        /* Sidebar Styles */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--darker);
            padding: 30px 0;
            height: 100vh;
            position: fixed;
            border-right: 1px solid rgba(255, 255, 255, 0.05);
            z-index: 100;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 40px;
            padding: 0 25px;
        }

        .logo h1 {
            font-size: 32px;
            font-weight: 800;
            background: linear-gradient(to right, var(--primary), #b56aff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -1px;
        }

        .logo-icon {
            margin-right: 12px;
            font-size: 28px;
            background: linear-gradient(to right, var(--primary), #b56aff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .nav-menu {
            list-style: none;
            padding: 0 15px;
        }

        .nav-item {
            margin: 8px 0;
            position: relative;
        }

        .nav-item.active {
            background: rgba(138, 43, 226, 0.1);
            border-radius: 8px;
        }

        .nav-link {
            display: flex;
            align-items: center;
            padding: 14px 20px;
            color: var(--light);
            text-decoration: none;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 8px;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-link.active {
            color: var(--primary);
        }

        .nav-link i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        /* Main Content Styles */
        .main-content {
            flex: 1;
            margin-left: var(--sidebar-width);
            padding: 40px;
            position: relative;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .page-title h2 {
            font-size: 28px;
            font-weight: 700;
            color: var(--light);
        }

        .page-title h2 span {
            background: linear-gradient(to right, var(--primary), #b56aff);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        .user-profile {
            display: flex;
            align-items: center;
            background: var(--gray);
            padding: 8px 15px;
            border-radius: 50px;
            border: 1px solid rgba(255, 255, 255, 0.05);
        }

        .user-profile img {
            width: 36px;
            height: 36px;
            border-radius: 50%;
            margin-right: 10px;
            object-fit: cover;
        }

        .user-profile .username {
            font-weight: 500;
            margin-right: 8px;
        }

        .user-profile .status {
            width: 10px;
            height: 10px;
            background: #e63946;
            border-radius: 50%;
        }

        .user-profile .status.connected {
            background: #2a9d8f;
        }

        /* Card Styles */
        .card {
            background: var(--gray);
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 25px rgba(138, 43, 226, 0.2);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .card-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--light);
        }

        .card-title i {
            margin-right: 10px;
            color: var(--primary);
        }

        /* Executor Styles */
        .editor-container {
            position: relative;
        }

        .editor-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .editor-title {
            font-size: 16px;
            font-weight: 500;
            color: var(--light);
        }

        .editor-actions {
            display: flex;
            gap: 12px;
        }

        .btn {
            padding: 10px 18px;
            border-radius: 8px;
            border: none;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(to right, var(--primary), #b56aff);
            color: white;
            font-weight: 600;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(138, 43, 226, 0.4);
        }

        .btn-outline {
            background: transparent;
            color: var(--light);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .btn-outline:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .btn-sm {
            padding: 8px 14px;
            font-size: 13px;
        }

        .code-editor {
            width: 100%;
            min-height: 200px;
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            color: #f8f8f2;
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 14px;
            line-height: 1.6;
            border: 1px solid rgba(138, 43, 226, 0.2);
            resize: vertical;
            margin-bottom: 15px;
            transition: border 0.3s ease;
        }

        .code-editor:focus {
            outline: none;
            border: 1px solid var(--primary);
            box-shadow: 0 0 0 2px rgba(138, 43, 226, 0.2);
        }

        .output-container {
            background: #1a1a1a;
            border-radius: 8px;
            padding: 20px;
            min-height: 120px;
            border: 1px solid rgba(138, 43, 226, 0.2);
            font-family: 'Fira Code', 'Consolas', monospace;
            font-size: 14px;
            color: #f8f8f2;
            overflow-y: auto;
            max-height: 300px;
        }

        .output-title {
            color: var(--primary);
            margin-bottom: 15px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .output-content {
            white-space: pre-wrap;
            line-height: 1.6;
        }

        /* Connection Panel */
        .connection-form {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 10px;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            font-weight: 500;
        }

        .form-input {
            width: 100%;
            padding: 12px 16px;
            background: #1a1a1a;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: white;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .form-input:focus {
            outline: none;
            border: 1px solid var(--primary);
            box-shadow: 0 0 0 2px rgba(138, 43, 226, 0.2);
        }

        .connection-status {
            display: flex;
            align-items: center;
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.05);
        }

        .status-text {
            margin-left: 10px;
            font-weight: 500;
        }

        /* Script Hub */
        .scripts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .script-card {
            background: var(--gray);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.05);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .script-card:hover {
            transform: translateY(-5px);
            border-color: rgba(138, 43, 226, 0.3);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }

        .script-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(138, 43, 226, 0.2);
            color: var(--primary);
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .script-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--light);
        }

        .script-desc {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .script-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .script-author {
            display: flex;
            align-items: center;
            font-size: 13px;
            color: rgba(255, 255, 255, 0.6);
        }

        .script-author img {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            margin-right: 8px;
        }

        /* Logs */
        .log-entry {
            background: var(--gray);
            padding: 18px;
            border-radius: 8px;
            margin-bottom: 12px;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .log-entry:hover {
            background: var(--gray-light);
        }

        .log-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            align-items: center;
        }

        .log-title {
            font-weight: 600;
            color: var(--primary);
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .log-time {
            color: rgba(255, 255, 255, 0.5);
            font-size: 12px;
        }

        .log-content {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 20px;
        }

        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            color: rgba(255, 255, 255, 0.7);
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
            margin-right: 5px;
        }

        .tab:hover {
            color: white;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px 6px 0 0;
        }

        .tab.active {
            color: var(--primary);
            border-bottom: 2px solid var(--primary);
            background: rgba(138, 43, 226, 0.1);
            border-radius: 6px 6px 0 0;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 240px;
            }
            .main-content {
                padding: 30px;
            }
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 70px;
                padding: 20px 0;
            }
            
            .logo h1, .nav-link span {
                display: none;
            }
            
            .logo {
                justify-content: center;
                margin-bottom: 30px;
            }
            
            .nav-link {
                justify-content: center;
                padding: 14px;
            }
            
            .nav-link i {
                margin-right: 0;
                font-size: 20px;
            }
            
            .main-content {
                margin-left: 70px;
                padding: 20px;
            }

            .connection-form {
                grid-template-columns: 1fr;
            }
        }

        /* Animations */
        @keyframes pulse {
            0% { opacity: 0.6; }
            50% { opacity: 1; }
            100% { opacity: 0.6; }
        }

        .pulse {
            animation: pulse 1.5s infinite;
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar">
        <div class="logo">
            <span class="logo-icon"><i class="fas fa-code"></i></span>
            <h1>LUA</h1>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active">
                <a href="#" class="nav-link active" data-tab="dashboard">
                    <i class="fas fa-rocket"></i>
                    <span>Dashboard</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-tab="executor">
                    <i class="fas fa-terminal"></i>
                    <span>Executor</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-tab="scripthub">
                    <i class="fas fa-cube"></i>
                    <span>Script Hub</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-tab="game-logs">
                    <i class="fas fa-history"></i>
                    <span>Game Logs</span>
                </a>
            </li>
            <li class="nav-item">
                <a href="#" class="nav-link" data-tab="settings">
                    <i class="fas fa-cog"></i>
                    <span>Settings</span>
                </a>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
        <div class="header">
            <div class="page-title">
                <h2>LUA <span>Executor</span></h2>
                <p style="color: rgba(255,255,255,0.6); font-size: 14px; margin-top: 5px;">Server-side execution environment</p>
            </div>
            <div class="user-profile">
                <img src="https://cdn.discordapp.com/avatars/1207688714818429069/a_7c3a5e5e5e5e5e5e5e5e5e5e5e5e5e5?size=1024" alt="User">
                <span class="username" id="username-display">Not Connected</span>
                <div class="status" id="status-indicator"></div>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div class="tab-content active" id="dashboard-tab">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-plug"></i> Server Connection
                    </div>
                </div>
                <div class="connection-form">
                    <div class="form-group">
                        <label for="username" class="form-label">Username</label>
                        <input type="text" id="username" class="form-input" placeholder="Enter your username">
                    </div>
                    <div class="form-group">
                        <label for="discord-id" class="form-label">Discord ID</label>
                        <input type="text" id="discord-id" class="form-input" placeholder="Enter your Discord ID">
                    </div>
                </div>
                <div class="connection-status">
                    <button class="btn btn-primary" id="connect-btn">
                        <i class="fas fa-link"></i> Connect to Server
                    </button>
                    <button class="btn btn-outline" id="disconnect-btn" style="display: none;">
                        <i class="fas fa-unlink"></i> Disconnect
                    </button>
                    <div class="status-text" id="status-text">Status: Disconnected</div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-bolt"></i> Quick Execute
                    </div>
                    <button class="btn btn-sm btn-primary" id="quick-execute">
                        <i class="fas fa-play"></i> Run
                    </button>
                </div>
                <div class="editor-container">
                    <textarea class="code-editor" id="quick-editor" placeholder="-- Write your Lua script here...&#10;print('Hello, LUA!')"></textarea>
                    <div class="output-container">
                        <div class="output-title">
                            <i class="fas fa-terminal"></i> Output
                        </div>
                        <div class="output-content" id="quick-output">> Ready to execute scripts...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Executor Tab -->
        <div class="tab-content" id="executor-tab">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-code"></i> Lua Executor
                    </div>
                    <div class="editor-actions">
                        <button class="btn btn-sm btn-outline" id="clear-editor">
                            <i class="fas fa-trash"></i> Clear
                        </button>
                        <button class="btn btn-sm btn-outline" id="save-script">
                            <i class="fas fa-save"></i> Save
                        </button>
                        <button class="btn btn-sm btn-primary" id="execute-script">
                            <i class="fas fa-play"></i> Execute
                        </button>
                    </div>
                </div>
                <div class="editor-container">
                    <textarea class="code-editor" id="main-editor" placeholder="-- Write your Lua script here...&#10;print('Hello, LUA!')"></textarea>
                    <div class="output-container">
                        <div class="output-title">
                            <i class="fas fa-terminal"></i> Output
                        </div>
                        <div class="output-content" id="main-output">> Ready to execute scripts...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Script Hub Tab -->
        <div class="tab-content" id="scripthub-tab">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-cubes"></i> Script Hub
                    </div>
                    <div class="editor-actions">
                        <button class="btn btn-sm btn-outline" id="refresh-scripts">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                </div>
                <div class="scripts-grid" id="scripts-container">
                    <!-- Scripts will be loaded here -->
                    <div class="script-card pulse" style="text-align: center; color: rgba(255,255,255,0.6);">
                        <i class="fas fa-spinner fa-spin" style="font-size: 24px; margin-bottom: 10px;"></i>
                        <p>Loading scripts...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Game Logs Tab -->
        <div class="tab-content" id="game-logs-tab">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-history"></i> Execution Logs
                    </div>
                    <div class="editor-actions">
                        <button class="btn btn-sm btn-outline" id="refresh-logs">
                            <i class="fas fa-sync-alt"></i> Refresh
                        </button>
                    </div>
                </div>
                <div class="tabs">
                    <div class="tab active" data-log-type="all">All Logs</div>
                    <div class="tab" data-log-type="executions">Executions</div>
                    <div class="tab" data-log-type="errors">Errors</div>
                    <div class="tab" data-log-type="connections">Connections</div>
                </div>
                <div id="logs-container">
                    <div class="log-entry">
                        <div class="log-header">
                            <div class="log-title">
                                <i class="fas fa-info-circle"></i> System
                            </div>
                            <div class="log-time">Just now</div>
                        </div>
                        <div class="log-content">
                            LUA executor initialized. Waiting for connection...
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="tab-content" id="settings-tab">
            <div class="card">
                <div class="card-header">
                    <div class="card-title">
                        <i class="fas fa-cog"></i> Settings
                    </div>
                </div>
                <div style="padding: 20px;">
                    <h3 style="margin-bottom: 20px; color: var(--primary);">Executor Settings</h3>
                    
                    <div class="form-group" style="margin-bottom: 25px;">
                        <label class="form-label">Theme</label>
                        <div style="display: flex; gap: 15px;">
                            <button class="btn btn-outline" style="flex: 1; background: #121212; border-color: #8a2be2;">
                                Dark Purple
                            </button>
                            <button class="btn btn-outline" style="flex: 1;">
                                Light
                            </button>
                            <button class="btn btn-outline" style="flex: 1;">
                                Black
                            </button>
                        </div>
                    </div>
                    
                    <div class="form-group" style="margin-bottom: 25px;">
                        <label class="form-label">Editor Font Size</label>
                        <input type="range" min="12" max="18" value="14" class="form-input" style="padding: 0;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Whitelist Information</label>
                        <button class="btn btn-outline" id="check-whitelist" style="width: 100%;">
                            <i class="fas fa-key"></i> Check Whitelist Status
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Whitelist Modal -->
    <div class="modal" id="whitelist-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 1000; align-items: center; justify-content: center;">
        <div class="card" style="width: 90%; max-width: 500px;">
            <div class="card-header">
                <div class="card-title">
                    <i class="fas fa-key"></i> Whitelist Status
                </div>
                <button class="btn btn-sm btn-outline" id="close-modal-btn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div style="padding: 20px;">
                <div style="background: rgba(138, 43, 226, 0.1); padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: rgba(255,255,255,0.7);">Username:</span>
                        <span style="font-weight: 500;" id="modal-username">N/A</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                        <span style="color: rgba(255,255,255,0.7);">Discord ID:</span>
                        <span style="font-weight: 500;" id="modal-discord">N/A</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span style="color: rgba(255,255,255,0.7);">Access Level:</span>
                        <span style="font-weight: 600; color: var(--primary);" id="modal-whitelist">N/A</span>
                    </div>
                </div>
                <p style="color: rgba(255,255,255,0.6); font-size: 14px; line-height: 1.5;">
                    Your whitelist level determines which scripts you can access. 
                    Contact support if you believe there's an error with your access level.
                </p>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let currentUser = null;
        let whitelistData = [];
        let scriptsData = [];
        let isConnected = false;

        // DOM Elements
        const tabContents = document.querySelectorAll('.tab-content');
        const navLinks = document.querySelectorAll('.nav-link');
        const usernameInput = document.getElementById('username');
        const discordIdInput = document.getElementById('discord-id');
        const connectBtn = document.getElementById('connect-btn');
        const disconnectBtn = document.getElementById('disconnect-btn');
        const statusIndicator = document.querySelector('#status-indicator');
        const statusText = document.getElementById('status-text');
        const usernameDisplay = document.getElementById('username-display');
        const checkWhitelistBtn = document.getElementById('check-whitelist');
        const scriptsContainer = document.getElementById('scripts-container');
        const refreshScriptsBtn = document.getElementById('refresh-scripts');
        const mainEditor = document.getElementById('main-editor');
        const quickEditor = document.getElementById('quick-editor');
        const mainOutput = document.getElementById('main-output');
        const quickOutput = document.getElementById('quick-output');
        const executeScriptBtn = document.getElementById('execute-script');
        const quickExecuteBtn = document.getElementById('quick-execute');
        const clearEditorBtn = document.getElementById('clear-editor');
        const saveScriptBtn = document.getElementById('save-script');
        const whitelistModal = document.getElementById('whitelist-modal');
        const closeModalBtn = document.getElementById('close-modal-btn');
        const modalUsername = document.getElementById('modal-username');
        const modalDiscord = document.getElementById('modal-discord');
        const modalWhitelist = document.getElementById('modal-whitelist');
        const logsContainer = document.getElementById('logs-container');
        const refreshLogsBtn = document.getElementById('refresh-logs');
        const logTabs = document.querySelectorAll('.tab[data-log-type]');

        // Tab switching
        navLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const tabId = this.getAttribute('data-tab');
                
                // Update active nav item
                navLinks.forEach(l => l.classList.remove('active'));
                document.querySelectorAll('.nav-item').forEach(i => i.classList.remove('active'));
                this.classList.add('active');
                this.parentElement.classList.add('active');
                
                // Show corresponding tab
                tabContents.forEach(tab => tab.classList.remove('active'));
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });

        // Log tabs
        logTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                logTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                // In a real app, you would filter logs here
            });
        });

        // Connection system
        async function fetchWhitelistData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/RelaxxxX-Lab/Lua-things/refs/heads/main/Whitelist.json');
                whitelistData = await response.json();
                addLog('Whitelist data loaded successfully', 'system');
            } catch (error) {
                addLog(`Failed to load whitelist data: ${error.message}`, 'error');
            }
        }

        async function fetchScriptsData() {
            try {
                const response = await fetch('https://raw.githubusercontent.com/RelaxxxX-Lab/Lua-things/refs/heads/main/Scripts.json');
                scriptsData = await response.json();
                addLog('Scripts data loaded successfully', 'system');
                renderScripts();
            } catch (error) {
                addLog(`Failed to load scripts data: ${error.message}`, 'error');
            }
        }

        function connectUser() {
            const username = usernameInput.value.trim();
            const discordId = discordIdInput.value.trim();
            
            if (!username || !discordId) {
                addLog('Please enter both username and Discord ID', 'error');
                return;
            }
            
            // Check whitelist
            const userData = whitelistData.find(user => 
                user.User.toLowerCase() === username.toLowerCase() && 
                user.Discord === discordId
            );
            
            if (!userData) {
                addLog('User not found in whitelist', 'error');
                return;
            }
            
            currentUser = {
                username,
                discordId,
                whitelist: userData.Whitelist
            };
            
            isConnected = true;
            updateConnectionStatus();
            addLog(`User ${username} connected successfully (${userData.Whitelist} access)`, 'connection');
            
            // Update UI
            usernameDisplay.textContent = username;
            statusIndicator.classList.add('connected');
            statusText.textContent = `Status: Connected (${userData.Whitelist})`;
        }

        function disconnectUser() {
            addLog(`User ${currentUser.username} disconnected`, 'connection');
            currentUser = null;
            isConnected = false;
            updateConnectionStatus();
            usernameDisplay.textContent = 'Not Connected';
            statusText.textContent = 'Status: Disconnected';
            statusIndicator.classList.remove('connected');
        }

        function updateConnectionStatus() {
            if (isConnected) {
                connectBtn.style.display = 'none';
                disconnectBtn.style.display = 'block';
            } else {
                connectBtn.style.display = 'block';
                disconnectBtn.style.display = 'none';
            }
        }

        // Script system
        function renderScripts() {
            scriptsContainer.innerHTML = '';
            
            if (!scriptsData.length) {
                scriptsContainer.innerHTML = '<div class="script-card" style="text-align: center; color: rgba(255,255,255,0.6);"><i class="fas fa-exclamation-circle"></i><p>No scripts available</p></div>';
                return;
            }
            
            scriptsData.forEach(script => {
                const isPremiumPlus = script.Name.includes('(Premium+)');
                const card = document.createElement('div');
                card.className = 'script-card';
                
                if (isPremiumPlus) {
                    card.innerHTML = `
                        <div class="script-badge">PREMIUM+</div>
                        <div class="script-title">${script.Name.replace(' (Premium+)', '')}</div>
                        <div class="script-desc">Premium script requiring Ultimate or Premium+ whitelist</div>
                        <div class="script-footer">
                            <div class="script-author">
                                <img src="https://cdn.discordapp.com/avatars/1207688714818429069/a_7c3a5e5e5e5e5e5e5e5e5e5e5e5e5e5?size=1024" alt="Author">
                                <span>RelaxxxX-Lab</span>
                            </div>
                            <button class="btn btn-sm btn-primary" data-script='${encodeURIComponent(script.Script)}' data-script-name="${script.Name.replace(' (Premium+)', '')}">
                                <i class="fas fa-download"></i> Load
                            </button>
                        </div>
                    `;
                } else {
                    card.innerHTML = `
                        <div class="script-title">${script.Name}</div>
                        <div class="script-desc">Standard script available to all whitelisted users</div>
                        <div class="script-footer">
                            <div class="script-author">
                                <img src="https://cdn.discordapp.com/avatars/1207688714818429069/a_7c3a5e5e5e5e5e5e5e5e5e5e5e5e5?size=1024" alt="Author">
                                <span>RelaxxxX-Lab</span>
                            </div>
                            <button class="btn btn-sm btn-primary" data-script='${encodeURIComponent(script.Script)}' data-script-name="${script.Name}">
                                <i class="fas fa-download"></i> Load
                            </button>
                        </div>
                    `;
                }
                
                scriptsContainer.appendChild(card);
            });
            
            // Add event listeners to script buttons
            document.querySelectorAll('[data-script]').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!isConnected) {
                        addLog('You must be connected to load scripts', 'error');
                        return;
                    }
                    
                    const script = decodeURIComponent(this.getAttribute('data-script'));
                    const scriptName = this.getAttribute('data-script-name');
                    
                    if (scriptName.includes('(Premium+)') && currentUser.whitelist !== 'Ultimate' && currentUser.whitelist !== 'Premium') {
                        addLog('This script requires Premium+ whitelist', 'error');
                        return;
                    }
                    
                    // Replace 'Username' with actual username in the script
                    const finalScript = script.replace(/Username/g, currentUser.username);
                    
                    // Load into main editor
                    mainEditor.value = finalScript;
                    addLog(`Script "${scriptName}" loaded into editor`, 'system');
                    
                    // Switch to executor tab
                    document.querySelector('[data-tab="executor"]').click();
                });
            });
        }

        // Execution system
        function executeScript(editor, outputElement) {
            if (!isConnected) {
                addLog('You must be connected to execute scripts', 'error', outputElement);
                return;
            }
            
            const code = editor.value.trim();
            if (!code) {
                addLog('Please enter some code to execute', 'error', outputElement);
                return;
            }
            
            addLog('Executing script...', 'system', outputElement);
            
            // Simulate execution (in a real app, this would communicate with your backend)
            setTimeout(() => {
                try {
                    // This is just a simulation - in a real app you'd need proper Lua execution
                    if (code.includes('print(')) {
                        const matches = code.match(/print\(([^)]+)\)/g);
                        if (matches) {
                            matches.forEach(match => {
                                const content = match.replace(/print\((['"]?)(.*?)\1\)/, '$2');
                                addLog(`> ${content}`, 'execution', outputElement);
                            });
                        } else {
                            addLog('> Script executed successfully (simulated)', 'execution', outputElement);
                        }
                    } else {
                        addLog('> Script executed successfully (simulated)', 'execution', outputElement);
                    }
                } catch (e) {
                    addLog(`> Error: ${e.message}`, 'error', outputElement);
                }
            }, 1000);
        }

        // Logging system
        function addLog(message, type = 'system', outputElement = null) {
            const logTypes = {
                'system': { icon: 'info-circle', color: '#8a2be2' },
                'error': { icon: 'exclamation-circle', color: '#e63946' },
                'execution': { icon: 'code', color: '#2a9d8f' },
                'connection': { icon: 'plug', color: '#f4a261' }
            };
            
            const logType = logTypes[type] || logTypes.system;
            const timestamp = new Date().toLocaleTimeString();
            
            // Add to game logs
            const logEntry = document.createElement('div');
            logEntry.className = 'log-entry';
            logEntry.style.borderLeftColor = logType.color;
            logEntry.innerHTML = `
                <div class="log-header">
                    <div class="log-title">
                        <i class="fas fa-${logType.icon}"></i> ${type.charAt(0).toUpperCase() + type.slice(1)}
                    </div>
                    <div class="log-time">${timestamp}</div>
                </div>
                <div class="log-content">${message}</div>
            `;
            logsContainer.prepend(logEntry);
            
            // Add to output if specified
            if (outputElement) {
                const currentContent = outputElement.innerHTML;
                outputElement.innerHTML = `${currentContent}\n> [${timestamp}] ${message}`;
                outputElement.scrollTop = outputElement.scrollHeight;
            }
        }

        // Event listeners
        connectBtn.addEventListener('click', connectUser);
        disconnectBtn.addEventListener('click', disconnectUser);
        checkWhitelistBtn.addEventListener('click', () => {
            if (!isConnected) {
                addLog('You must be connected to check whitelist', 'error');
                return;
            }
            
            modalUsername.textContent = currentUser.username;
            modalDiscord.textContent = currentUser.discordId;
            modalWhitelist.textContent = currentUser.whitelist;
            whitelistModal.style.display = 'flex';
        });
        refreshScriptsBtn.addEventListener('click', fetchScriptsData);
        executeScriptBtn.addEventListener('click', () => executeScript(mainEditor, mainOutput));
        quickExecuteBtn.addEventListener('click', () => executeScript(quickEditor, quickOutput));
        clearEditorBtn.addEventListener('click', () => {
            mainEditor.value = '';
            addLog('Editor cleared', 'system');
        });
        saveScriptBtn.addEventListener('click', () => {
            if (!mainEditor.value.trim()) {
                addLog('No code to save', 'error');
                return;
            }
            addLog('Script saved locally (simulated)', 'system');
            // In a real app, this would save to localStorage or backend
        });
        closeModalBtn.addEventListener('click', () => {
            whitelistModal.style.display = 'none';
        });
        refreshLogsBtn.addEventListener('click', () => {
            addLog('Logs refreshed', 'system');
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            fetchWhitelistData();
            fetchScriptsData();
            addLog('LUA executor initialized', 'system');
        });
    </script>
</body>
</html>
